===================
Rasman User's Guide
===================

What is it?
-----------

Rasman (Raspberry Pi Manager) is an open-source software that lets you control 
the BioMonstaaar algae bioreactor, automatically upload your bioreactor's data  
to the BioMonstaar portal and share data with others.

To use Rasman, install it on the Pi and make sure the Pi is connected to your 
home/office network via an Ethernet cable or Wifi. Then fire up a browser on 
your computer and go to:

    http://rasman.local


How it works
------------

The BioMonstaaar algae bioreactor consists of one or more reactor columns. Each
column is equipped with sensors to monitor temperature, pH, CO2 level, etc. to
observe algae growth. The column also has actuators to control the nutrient feed,
culture mixing and algae harvesting. The sensors and actuators are interfaced to
an Arduino microcontroller which serves as the controller of the reactor column.

A Raspberry Pi microcomputer is used as the main system controller. It communicates
with each Arduino to read the reactor columns sensor measurements or sends commands
to control the actuators.

Rasman runs as a web application on the Raspberry Pi, allowing users to control 
the bioreactor from a browser.

Key Features
------------

   * small footprint
   * runs in headless mode.
      * just plug-and-play
      * no need to connect keyboard, mouse and monitor (unless you want to)


Installation Guide
------------------

1. If you haven't done so, create a bootable Raspbian image on an SD card. For detailed 
instructions, see the eLinux `RPi Easy SDcard Setup <http://elinux.org/RPi_Easy_SD_Card_Setup>`_. 
In my case, I followed the command line procedure for Mac (Section 3.3.3), summarized 
below.

* `Download <http://www.raspberrypi.org/downloads>`_ the Raspbian Wheezy raw image and unzip.
* Insert a blank SD card into the Mac's slot.

Open a terminal console the run these commands:

* Identify the disk (not partition) of your SD card and unmount it.

::

    $ diskutil list
    $ diskutil unmountDisk /dev/disk2

* Write the image to the card. This will take several minutes! *NOTE:* I wrote the image to raw disk (rdisk2) for faster copying.

::

    $ sudo dd bs=1m if="2013-07-26-wheezy-raspbian.img" of=/dev/rdisk2 

    1850+0 records in
    1850+0 records out
    1939865600 bytes transferred in 371.561630 secs (5220845 bytes/sec)

* Insert the card to the Pi and power it up.

2. Change keyboard to US layout

::

    $cd /etc/default
    $sudo vi keyboard

    Change the value of XKBLAYOUT to "us".

    $ sudo reboot

3. Install pip

::

    $ sudo apt-get install python-setuptools
    $ sudo easy_install pip

4. Install Flask

::

    $ sudo pip install Flask

5. (optional) Change the Pi's hostname

    http://www.howtogeek.com/167195/how-to-change-your-raspberry-pi-or-other-linux-devices-hostname/
    
::

    $ sudo vi /etc/hosts

    Leave all of the entries alone except for the very last entry labeled 127.0.1.1 with the hostname “raspberrypi“. This is the only line you want to edit. Replace “raspberrypi” with whatever hostname you desire.

    $ sudo vi /etc/hostname

    Change the name from “raspberrypi” to the new hostname.

    $ sudo reboot

6. Make the Pi addressable by other computers by hostname

http://elinux.org/RPi_Advanced_Setup

Make sure your package lists are up to date before you install.

    $ sudo apt-get update

7. Install the Avahi 

::
    $ sudo apt-get install avahi-daemon
    $ sudo insserv avahi-daemon

    $ sudo vi /etc/avahi/services/multiple.service 

  1. The contents of this file should be something like the following, courtesy of aXon on the Rasperry Pi forums:<?xml version="1.0" standalone='no'?><!DOCTYPE service-group SYSTEM "avahi-service.dtd"><service-group>        <name replace-wildcards="yes">%h</name>        <service>                <type>_device-info._tcp</type>                <port>0</port>                <txt-record>model=RackMac</txt-record>        </service>        <service>                <type>_ssh._tcp</type>                <port>22</port>        </service></service-group>
  2. Apply the new configuration with:sudo /etc/init.d/avahi-daemon restart


At this point, you should be able to remotely log into the box:

    ssh pi@rasman.local

or access the app from a browser on your computer:

    http://rasman.local/

 
